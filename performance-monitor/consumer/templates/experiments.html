{% import time %}
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="{{static_url('css/bootstrap.min.css')}}"/>
<link rel="stylesheet" href="{{static_url('css/legend.css')}}"/>
<link rel="stylesheet" href="{{static_url('css/experiments.css')}}"/>
<link media="screen" rel="stylesheet" href="{{static_url('css/bootstrap-multiselect.css')}}" />
<script src="{{static_url('js/jquery-1.11.2.min.js')}}"></script>
<script src="{{static_url('js/bootstrap.min.js')}}"></script>
<script src="{{static_url('js/ZeroClipboard.js')}}"></script>
<script src="{{static_url('js/Chart.min.js')}}">
	var Chartjs = Chart.noConflict();
</script>
<script src="{{static_url('js/legend.js')}}"></script>
<script src="{{static_url('js/bootstrap-multiselect.js')}}"></script>
<script src="{{static_url('js/utils.js')}}"></script>
<script src="{{static_url('js/experiments.js')}}"></script>
<title>Experiments - {{data['type']}}</title>
</head>
<body>
<section class="container">
	<h1>{{data['type'].capitalize()}}</h1>
	<div id="analysis">
		<div class="form-inline">
		{% for k in opts %}
			<div class="form-group">
			{% if k != 'sites' %}
				<div id="{{k}}" class="dropdown">
					<button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="true">{{' '.join(k.split('-')).capitalize()}}<span class="caret"></span></button>
				  	<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownDivider">
					  	<li class="clear" role="presentation" data-title="{{' '.join(k.split('-')).capitalize()}}"><a role="menuitem" tabindex="-1" href="#">Clear</a></li>
					  	<li role="presentation" class="divider"></li>
					  	{% for i in opts[k] %}
					    	<li class="entry" role="presentation"><a role="menuitem" tabindex="-1" href="#">{{i['name'].capitalize()}}</a></li>
					    {% end %}
				 	 </ul>
				</div>
			</div>
			{% end %}
		{% end %}
		<div class="form-group">
			<div id="master-site" class="dropdown">
					<button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="true">Master Site<span class="caret"></span></button>
				  	<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownDivider">
					  	<li class="clear" role="presentation" data-title="Master Site"><a role="menuitem" tabindex="-1" href="#">Clear</a></li>
					  	<li class="entry" role="presentation" class="divider"></li>
					  	{% for i in opts['sites'] %}
					    	<li class="entry" role="presentation"><a role="menuitem" tabindex="-1" href="#">{{i['name'].upper()}}</a></li>
					    {% end %}
				 	 </ul>
			</div>
		</div>
		<div class="form-group">
			<select id="worker-sites" multiple="multiple">
				{% for i in opts['sites'] %}
					<option value="{{i['name']}}">{{i['name'].upper()}}</option>
				{% end %}
			</select>
		</div>
		
			<div class="form-group">
				<input id="worker-num" class="form-control" type="number" placeholder="# of Workers"/>
			</div>
			<div class="form-group">
				<input id="workload" class="form-control"  type="number" placeholder="# of Workloads"/>
			</div>
			<div class="form-group">
				<input id="bandwidth" class="form-control"  type="number" placeholder="Bandwidth(Mbps)"/>
			</div>
			<button id="search" class="btn btn-success pull-right">Search</button>
		</div>
		
	</div>
	
	
	<h2>Experiments</h2>
	<div id="table-content">
	<table class="table table-hover">
		<thead><tr>
			<th class="exp-id">Experiment ID</th>
			<th class="topology">Topology</th>
			<th class="mode">Mode</th>
			<th class="master-site">Master Site</th>
			<th class="worker-site">Worker Sites</th>
			<th class="worker-num">Number of Workers</th>
			<th class="worker-size">Worker Size</th>
			<th class="workload-size">Workload Size</th>
			<th class="bandwidth">Bandwidth</th>
			<th class="create-time">Create Time</th>
			<th class="status">Status</th>
			<th class="ops">Operations</th>
		</tr></thead>
		<tbody>
			
			{% for e in data['experiments'] %}
			<tr>
				<td id="{{e['exp_id']}}" class="exp-id"><a href="{{'%s/experiments/%s' % (data['current_uri'], e['exp_id'])}}">{{e['exp_id']}}</a></td>
				<td class="topology">{{e['topology']}}</td>
				<td class="mode">{{e['mode']}}</td>
				<td class="master-site">{{e['master_site'].upper()}}</td>
				<td class="worker-site">{{','.join([s['site'].upper() for s in e['worker_sites']]) if 'worker_sites' in e else '-'}}</td>
				<td class="worker-num">{{sum([int(s['num']) for s in e['worker_sites']]) if e['mode'] == 'multinode' else '-'}}</td>
				<td class="worker-size">{{e['worker_size']}}</td>
				<td class="workload-size">{{e['run_num']}}</td>
				<td class="bandwidth">{{e['bandwidth'] / (1000 * 1000) if e['mode'] == 'multinode' else '-'}}</td>
				<td class="create-time">{{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(e['create_time']))}}</td>
				<td class="status">{{e['status']}}</td>
				<td class="ops">
					<button class="btn btn-success glyphicon glyphicon-file copy" data-clipboard-target="{{e['exp_id']}}"></button>
					<button class="btn btn-warning glyphicon glyphicon-repeat redo"></button>
					<button class="btn btn-danger glyphicon glyphicon-remove del-experiment"></button>
				</td>
			</tr>
			{% end %}
		</tbody>
	</table>
	</div>
	<h2>Analysis</h2>
	<div id="walltime">
			<canvas></canvas>
			<div></div>
			<div id='std-dev'></div>
		</div>
</section>
</body>
</html>