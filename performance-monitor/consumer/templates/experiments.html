{% import time %}
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" href="{{static_url('css/bootstrap.min.css')}}"/>
<link rel="stylesheet" href="{{static_url('css/global.css')}}"/>
<link rel="stylesheet" href="{{static_url('css/legend.css')}}"/>
<link rel="stylesheet" href="{{static_url('css/experiments.css')}}"/>
<link media="screen" rel="stylesheet" href="{{static_url('css/bootstrap-multiselect.css')}}" />
<script src="{{static_url('js/jquery-1.11.2.min.js')}}"></script>
<script src="{{static_url('js/bootstrap.min.js')}}"></script>
<script src="{{static_url('js/ZeroClipboard.js')}}"></script>
<script src="{{static_url('js/Chart.min.js')}}">
	var Chartjs = Chart.noConflict();
</script>
<script src="{{static_url('js/legend.js')}}"></script>
<script src="{{static_url('js/bootstrap-multiselect.js')}}"></script>
<script src="{{static_url('js/html2canvas.js')}}"></script>
<script src="{{static_url('js/canvas2image.js')}}"></script>
<script src="{{static_url('js/utils.js')}}"></script>
<script src="{{static_url('js/experiments.js')}}"></script>
<title>Experiments - {{data['type']}}</title>
</head>
<body>
<section class="container">
	<h1>{{data['type'].capitalize()}}</h1>
	<div id="analysis">
		<div class="form-inline">
		{% for k in opts %}
			<div class="form-group">
			{% if k != 'sites' %}
				<div id="{{k}}" class="dropdown">
					<button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="true">{{' '.join(k.split('-')).capitalize()}}<span class="caret"></span></button>
				  	<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownDivider">
					  	<li class="clear" role="presentation" data-title="{{' '.join(k.split('-')).capitalize()}}"><a role="menuitem" tabindex="-1" href="#">Clear</a></li>
					  	<li role="presentation" class="divider"></li>
					  	{% for i in opts[k] %}
					    	<li class="entry" role="presentation"><a role="menuitem" tabindex="-1" href="#">{{i['name'].capitalize() if isinstance(i, dict) else i.capitalize()}}</a></li>
					    {% end %}
				 	 </ul>
				</div>
			</div>
			{% end %}
		{% end %}
		<div class="form-group">
			<div id="master-site" class="dropdown">
					<button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown" aria-expanded="true">Master Site<span class="caret"></span></button>
				  	<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownDivider">
					  	<li class="clear" role="presentation" data-title="Master Site"><a role="menuitem" tabindex="-1" href="#">Clear</a></li>
					  	<li class="entry" role="presentation" class="divider"></li>
					  	{% for i in opts['sites'] %}
					    	<li class="entry" role="presentation"><a role="menuitem" tabindex="-1" href="#">{{i['name'].upper()}}</a></li>
					    {% end %}
				 	 </ul>
			</div>
		</div>
		<div class="form-group">
			<select id="worker-sites" multiple="multiple">
				{% for i in opts['sites'] %}
					<option value="{{i['name']}}">{{i['name'].upper()}}</option>
				{% end %}
			</select>
		</div>
		
			<div class="form-group">
				<input id="worker-num" class="form-control" type="number" placeholder="# of Workers"/>
			</div>
			<div class="form-group">
				<input id="workload" class="form-control"  type="number" placeholder="# of Workloads"/>
			</div>
			<div class="form-group">
				<input id="bandwidth" class="form-control"  type="number"  placeholder="Bandwidth(Mbps)"/>
			</div>
			<div class="form-group">
				<input id="limit" class="form-control"  type="number"  placeholder="Top"/>
			</div>
			
			<button id="search" class="btn btn-success pull-right">Search</button>
		</div>
		
	</div>
	
	
	<h2>Experiments</h2>
	<div id="table-content">
	<table class="table table-hover">
		<thead><tr>
			<th class="exp-id">Experiment ID</th>
			<th class="topology"><a class="sort" data-key="topology">Topology</a></th>
			<th class="deployment"><a class="sort" data-key="deployment">Deployment</a></th>
			<th class="master-site"><a class="sort" data-key="master_site">Master Site</a></th>
			<th class="worker-site"><a class="sort" data-key="worker_sites">Worker Sites</a></th>
			<th class="worker-num"><a class="sort" data-key="num_of_workers"># of Workers</a></th>
			<th class="worker-size"><a class="sort" data-key="worker_size">Worker Size</a></th>
			<th class="workload"><a class="sort" data-key="workload"># of Workloads</a></th>
			<th class="bandwidth"><a class="sort" data-key="bandwidth">Bandwidth</a></th>
			<th class="create-time"><a class="sort" data-key="create_time">Create Time</a></th>
			<th class="status"><a class="sort" data-key="status">Status</a></th>
			<th class="ops">Operations</th>
		</tr></thead>
		<tbody>
			
			{% for e in data['experiments'] %}
			<tr>
				<td id="{{e['exp_id']}}" class="exp-id"><a href="{{'/workflows/%s/experiments/%s' % (data['type'], e['exp_id'])}}">{{e['exp_id']}}</a></td>
				<td class="topology">{{e['topology']}}</td>
				<td class="deployment">{{e['deployment']}}</td>
				<td class="master-site">{{e['master_site'].upper()}}</td>
				<td class="worker-site">{{','.join([s['site'].upper() for s in e['worker_sites']]) if 'worker_sites' in e else '-'}}</td>
				<td class="worker-num">{{e['num_of_workers']}}</td>
				<td class="worker-size">{{e['worker_size']}}</td>
				<td class="workload">{{e['workload']}}</td>
				<td class="bandwidth">{{e['bandwidth'] if 'bandwidth' in e else '-'}}</td>
				<td class="create-time">{{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(e['create_time']))}}</td>
				<td class="status">{{e['status']}}</td>
				<td class="ops">
					<button class="btn btn-success glyphicon glyphicon-file copy" data-clipboard-target="{{e['exp_id']}}"></button>
 					<button class="btn btn-warning glyphicon glyphicon-repeat redo"></button> 
					<button class="btn btn-danger glyphicon glyphicon-remove del-experiment"></button>
					<button class="btn btn-default glyphicon glyphicon-minus noshow"></button>
				</td>
			</tr>
			{% end %}
		</tbody>
	</table>
	</div>
	<h2>System Analysis</h2>
	<h3>Walltime</h3>
	<div id="walltime" class="graph">
			<canvas></canvas>
			<div></div>
			<div class="analysis">
				<div>Max: <span class="max"></span></div>
				<div>Min: <span class="min"></span></div>
				<div>Avg: <span class="avg"></span></div>
				<div>Standard Deviation: <span class="avg-std-dev"></span></div>
			</div>
	</div>
	<h3>System CPU Usage</h3>
	<div id="sys-cpu" class="graph">
			<canvas></canvas>
			<div></div>
			<div class="analysis">
				<div>Max: <span class="max"></span></div>
				<div>Min: <span class="min"></span></div>
				<div>Avg: <span class="avg"></span></div>
				<div>Max Standard Deviation: <span class="max-std-dev"></span></div>
				<div>Min Standard Deviation: <span class="min-std-dev"></span></div>
				<div>Avg Standard Deviation: <span class="avg-std-dev"></span></div>
			</div>
	</div>
	<h3>System Memory Usage</h3>
	<div id="sys-mem" class="graph">
			<canvas></canvas>
			<div></div>
			<div class="analysis">
				<div>Max: <span class="max"></span></div>
				<div>Min: <span class="min"></span></div>
				<div>Avg: <span class="avg"></span></div>
				<div>Max Standard Deviation: <span class="max-std-dev"></span></div>
				<div>Min Standard Deviation: <span class="min-std-dev"></span></div>
				<div>Avg Standard Deviation: <span class="avg-std-dev"></span></div>
			</div>
	</div>
	<h3>System Read Rate</h3>
	<div id="sys-read" class="graph">
			<canvas></canvas>
			<div></div>
			<div class="analysis">
				<div>Max: <span class="max"></span></div>
				<div>Min: <span class="min"></span></div>
				<div>Avg: <span class="avg"></span></div>
				<div>Max Standard Deviation: <span class="max-std-dev"></span></div>
				<div>Min Standard Deviation: <span class="min-std-dev"></span></div>
				<div>Avg Standard Deviation: <span class="avg-std-dev"></span></div>
			</div>
	</div>
	<h3>System Write Rate</h3>
	<div id="sys-write" class="graph">
			<canvas></canvas>
			<div></div>
			<div class="analysis">
				<div>Max: <span class="max"></span></div>
				<div>Min: <span class="min"></span></div>
				<div>Avg: <span class="avg"></span></div>
				<div>Max Standard Deviation: <span class="max-std-dev"></span></div>
				<div>Min Standard Deviation: <span class="min-std-dev"></span></div>
				<div>Avg Standard Deviation: <span class="avg-std-dev"></span></div>
			</div>
	</div>
	<h3>System Send Rate</h3>
	<div id="sys-send" class="graph">
			<canvas></canvas>
			<div></div>
			<div class="analysis">
				<div>Max: <span class="max"></span></div>
				<div>Min: <span class="min"></span></div>
				<div>Avg: <span class="avg"></span></div>
				<div>Max Standard Deviation: <span class="max-std-dev"></span></div>
				<div>Min Standard Deviation: <span class="min-std-dev"></span></div>
				<div>Avg Standard Deviation: <span class="avg-std-dev"></span></div>
			</div>
	</div>
	<h3>System Receive Rate</h3>
	<div id="sys-recv" class="graph">
			<canvas></canvas>
			<div></div>
			<div class="analysis">
				<div>Max: <span class="max"></span></div>
				<div>Min: <span class="min"></span></div>
				<div>Avg: <span class="avg"></span></div>
				<div>Max Standard Deviation: <span class="max-std-dev"></span></div>
				<div>Min Standard Deviation: <span class="min-std-dev"></span></div>
				<div>Avg Standard Deviation: <span class="avg-std-dev"></span></div>
			</div>
	</div>
</section>
</body>
</html>