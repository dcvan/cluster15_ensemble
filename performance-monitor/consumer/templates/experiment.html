{% import time %}
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>{{data['exp_id']}}</title>
<link rel="stylesheet" href="{{static_url('css/bootstrap.min.css')}}"/>
<link rel="stylesheet" href="{{static_url('css/experiment.css')}}"/>
<link rel="stylesheet" href="{{static_url('css/legend.css')}}"/>
<script src="{{static_url('js/jquery-1.11.2.min.js')}}"></script>
<script src="{{static_url('js/bootstrap.min.js')}}"></script>
<script src="{{static_url('js/ZeroClipboard.js')}}"></script>
<script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
<script src="{{static_url('js/legend.js')}}"></script>
<script src="{{static_url('js/utils.js')}}"></script>
<script src="{{static_url('js/experiment.js')}}"></script>
</head>
<body>
<section class="container">
	<h1>Experiment <small>created at {{data['create_time']}}</small></h1>
	<a href="/">Back</a>
	<button id="del" class="btn btn-danger pull-right">Delete</button>
	<button id="redo" class="btn btn-warning pull-right">Redo</button>
	<button id="copy" class="btn btn-info pull-right">Replicate</button>
	<button id="copy-id" class="btn btn-success pull-right" data-clipboard-target="exp-id">Copy ID</button>
	<dl class="dl-horizontal">
		<dt>Experiment ID</dt>
		<dd id="exp-id">{{data['exp_id']}}</dd>
		<dt>Type</dt>
		<dd>{{data['type']}}</dd>
		<dt>Topology</dt>
		<dd>{{data['topology']}}</dd>
		<dt>Mode</dt>
		<dd>{{data['mode']}}</dd>
		<dt>Master Site</dt>
		<dd>{{data['master_site'].upper()}}</dd>
		<dt>Worker Sites</dt>
		{% for s in data['worker_sites'] %}
		<dd>{{s['site'].upper()}}: {{s['num']}}</dd>
		{% end %}
		<dt>Storage Site</dt>
		<dd>{{data['storage_site']}}</dd>
		<dt>Storage Type</dt>
		<dd>{{data['storage_type']}}</dd>
		<dt>Status</dt>
		<dd>{{data['status']}}</dd>
		<dt>Worker Size</dt>
		<dd>{{data['worker_size']}}</dd>
		<dt>Reservation</dt>
		<dd>{{data['reservation']}} Days</dd>
		<dt>Bandwidth</dt>
		<dd>{{data['bandwidth'] if data['bandwidth'] else '-'}} Mbps</dd>
		<dt>Storage Size</dt>
		<dd>{{data['storage_size'] if data['storage_size'] else '-'}} GB</dd>
	</dl>
	<h2>Active Workers</h2>
	<table id="workers" class="table table-hover">
		<thead>
		<tr>
			<th>Name</th>
			<th>Site</th>
			<th>Identified at</th>
		</tr>
		</thead>	
		<tbody>
			{% for w in data['workers']%}
				<tr>
					<td><a href="{{'%s/workers/%s' % (current_uri, w['host'])}}">{{w['host']}}</a></td>
					<td>{{w['site'].upper()}}</td>
					<td>{{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime( w['timestamp']))}}</td>
				</tr>
			{% end %}
		</tbody>
	</table>

	<h2>Finished Runs</h2>
	<table id="runs" class="table table-hover">
		<thead>
		<tr>
			<th>Run</th>
			<th>Walltime</th>
			<th>Finished at</th>
		</tr>
		</thead>
		<tbody>
			{% for r in data['runs']%}
				<tr>
					<td>{{r['run_id']}}</td>
					<td>{{r['walltime']}}</td>
					<td>{{time.strftime('%Y-%m-%d %H:%M:%S', time.localtime(r['timestamp']))}}</td>
				</tr>
			{% end %}
		</tbody>
	</table>
	<form id="download" action="/workflows/{{data['type']}}/experiments/{{data['exp_id']}}" method="POST">
	<h2>Manifest <small><a href="#" onclick="$('#download').submit();">Download</a></small></h2>
	</form>
	<pre id="manifest" class="prettyprint lang-xml">
		{{manifest}}
	</pre>
</section>
</body>
</html>